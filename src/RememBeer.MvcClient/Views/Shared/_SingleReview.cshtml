@using RememBeer.MvcClient.Utils
@model RememBeer.MvcClient.Models.Reviews.SingleReviewViewModel

<div id="review-@Model.Id" class="card horizontal">
    <div class="row full-width">
        <div class="col s12 l4 center-align">
            <img class="materialboxed responsive-img" data-caption="@Model.BeerName @@ @Model.Place" src="@Model.ImgUrl" alt="Review image">
        </div>
        <div class="col s12 l8">
            <div class="card-content review-body">
                <div class="card-title">
                    <h5>
                        @Html.DisplayFor(x => x.BeerName)
                        <span>
                            @@<em>@Html.DisplayFor(x => x.Place)</em>
                        </span>
                        <small class="right">@Html.DisplayFor(x => x.CreatedAt)</small>
                    </h5>

                    <small>
                        @Html.DisplayFor(x => x.BeerBeerTypeType) <em>by @Html.DisplayFor(x => x.BeerBreweryName)</em>
                    </small>
                </div>
                @if (Model.IsEdit)
                {
                    <p>@Model.Description.Truncate(1024)</p>
                }
                else
                {
                    <p>@Html.DisplayFor(x => x.Description)</p>
                }
                <hr/>
                <ul class="list-inline flow-text">
                    <li>
                        <strong>
                            Overall:
                            <span>@Html.DisplayFor(x => x.Overall)</span>
                        </strong>
                    </li>
                    <li>|</li>
                    <li>
                        <strong>
                            Taste:
                            <span>@Html.DisplayFor(x => x.Taste)</span>
                        </strong>
                    </li>
                    <li>|</li>
                    <li>
                        <strong>
                            Looks:
                            <span>@Html.DisplayFor(x => x.Look)</span>
                        </strong>
                    </li>
                    <li>|</li>
                    <li>
                        <strong>
                            Aroma:
                            <span>@Html.DisplayFor(x => x.Smell)</span>
                        </strong>
                    </li>
                </ul>
            </div>
        </div>
        @if (Model.IsEdit)
        {
            <div class="card-action clearfix">
                @Ajax.ActionLink("Edit", "Edit", "Reviews",
                                 new { id = Model.Id, area = "" },
                                 new AjaxOptions()
                                 {
                                     HttpMethod = "GET",
                                     InsertionMode = InsertionMode.ReplaceWith,
                                     LoadingElementId = "loading",
                                     UpdateTargetId = "review-" + Model.Id,
                                     OnSuccess = "initMaterialize()",
                                     OnFailure = "handleAjaxError"
                                 },
                                 new { @class = "btn amber darken-2 white-text waves-effect waves-light" })

                <a class="btn deep-orange darken-2 white-text waves-effect waves-light modal-trigger " href="#deleteModal-@Model.Id">Delete</a>
                <a class="right" href="@Url.Action("Details", "Reviews", new { id = Model.Id, area = "" })">Share Link</a>
                <div class="clearfix"></div>
            </div>
        }
    </div>
</div>

<div id="deleteModal-@Model.Id" class="modal">
    @using ( Ajax.BeginForm("Index", "Reviews", new { id = Model.Id }, new AjaxOptions()
    {
        HttpMethod = "DELETE",
        InsertionMode = InsertionMode.ReplaceWith,
        LoadingElementId = "loading",
        UpdateTargetId = "review-" + Model.Id,
        OnSuccess = "$('.modal').modal('close');showSuccess('Review has been deleted!')",
        OnFailure = "handleAjaxError"
    }, new { }) )
    {
        @Html.AntiForgeryToken()

        <div class="modal-content">
            <h4>Are you sure you want to delete this review?</h4>
        </div>
            <div class="modal-footer">
                <input type="submit" class="btn deep-orange darken-2 white-text waves-effect waves-light" value="Delete" />
                <a href="#!" class="modal-action modal-close waves-effect waves-green btn-flat">Cancel</a>
            </div>
    }
</div>

